<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IUF-SDK-3: IUF file IO library V3</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IUF-SDK-3
   </div>
   <div id="projectbrief">Interventional Ultrasound Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">IUF file IO library V3 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Overview"></a>
Overview</h1>
<p>The IUF library provides an API for reading and writing Ultrasound data and -derived and related data to HDF5 files.</p>
<p>Conceptually, Ultrasound data is processed in an algorithm chain starting with beamforming, followed by property extraction such as signal intensity or velocity maps, and imaging steps such as compression and clutter reduction, etc. and or analysis steps such as tissue characterization. Additional data streams, such as ECG, are relevant enhancement data.</p>
<p>This library facilitates such processing chains by providing abstract datatypes and functions for file IO. The HDF5 file format is used to store the following meta-data acquisition properties and settings processing parameters and settings the history of all previous processing parameters and settings. Since the meta-data is very small (10s of kBytes) typically compared to the data itself (100s of MBytes), storing all metadata of each processing step remains relatively little overhead. In order to cope with various processing chain implementations and versions of each processing step is considered a <a class="el" href="iuf_history_node_a_d_t_8h.html#struct_iuf_history_node">IufHistoryNode</a> that has a "history" in the form of parents (a list of <a class="el" href="iuf_history_node_a_d_t_8h.html#struct_iuf_history_node">IufHistoryNode</a> s), node specific properties (identified by the node type and optional algorithm parameters). In the following sections we will describe the implemented Nodes types.</p>
<h1><a class="anchor" id="iufInputFile"></a>
iufInputFile</h1>
<p>The image below shows the schematic structure of an <a class="el" href="iuf_input_file_8c.html#struct_iuf_input_file">IufInputFile</a> </p><div class="image">
<img src="Slide1.png" alt="Slide1.png"/>
</div>
<p> The header contains a <a class="el" href="iuf_frame_list_8c.html#struct_iuf_frame_list">IufFrameList</a> where each <a class="el" href="iuf_frame_8c.html#struct_iuf_frame">IufFrame</a> consists of a reference to a <a class="el" href="iuf_pattern_list_8c.html#struct_iuf_pattern_list">IufPatternList</a> and a timestamp. The <a class="el" href="iuf_pattern_list_8c.html#struct_iuf_pattern_list">IufPatternList</a> is a list of <a class="el" href="iuf_pattern_8c.html#struct_iuf_pattern">IufPattern</a>. Which each contain references to 5 additional dictionaries: <a class="el" href="iuf_source_private_8h.html#struct_iuf_source">IufSource</a>, <a class="el" href="iuf_receive_settings_8c.html#struct_iuf_receive_settings">IufReceiveSettings</a>, <a class="el" href="iuf_receive_channel_map_a_d_t_8h.html#struct_iuf_receive_channel_map">IufReceiveChannelMap</a>, <a class="el" href="iuf_transmit_apodization_private_8h.html#struct_iuf_transmit_apodization">IufTransmitApodization</a> and <a class="el" href="iuf_pulse_private_8h.html#struct_iuf_pulse">IufPulse</a>. Together these 5 objects from each dictionary describe the pattern. See the subsections blow.</p>
<p>In addition, an <a class="el" href="iuf_input_file_8c.html#struct_iuf_input_file">IufInputFile</a> contains a transducer description <a class="el" href="iuf_transducer_a_d_t_8h.html#struct_iuf_transducer">IufTransducer</a> and the acquistion method <a class="el" href="iuf_acquisition_a_d_t_8h.html#struct_iuf_acquisition" title="An Ultrasound acquisition is identified by a date and a description, also the speed of sound has been...">IufAcquisition</a>.</p>
<p>The data is stored in a 4D block of floats for each <a class="el" href="iuf_pattern_list_8c.html#struct_iuf_pattern_list">IufPatternList</a> with dimensions: numChannels x numSamplesPerLine x numPulses x numFrames. Note that this implies that these 4 dimension of each pattern in a patternList are constant. This is checked by the library when constructing a patternList using <a class="el" href="iuf_pattern_list_8h.html#a188dc5df3b7324af5dddba5f48a3294f" title="Create a patternList of size numPattern. Using the IufReceiveSettingsDict and IufReceiveChannelMapDic...">iufPatternListCreate()</a> and <a class="el" href="iuf_pattern_list_8h.html#a8cf124030fa4420cbfe9603e250a327b" title="Set a pattern at index in the IufPatternList. ">iufPatternListSet()</a>.</p>
<h2><a class="anchor" id="IufSourceDict"></a>
IufSourceDict</h2>
<p>The source dictionary contains a set of source types. A source does not have to contain a single point source, it can also contain multiple point sources, for example to approximate a line source or for creating transversal waves. The locations of the sources are either specified in 2D or 3D space and either parametric or non-paramteric, as such there are four options for an <a class="el" href="iuf_source_8h.html#aeca7c02cb00683b0d8c88ee4efb5d6f3">IufSourceType</a>.</p>
<p>There is typically no need to define the generic <a class="el" href="iuf_source_private_8h.html#struct_iuf_source">IufSource</a> Type, instead the API provides functions for each of the four types separately. For example, to define a source in 3D space that approximates a circlular arc (described by startPhi, deltaPhi) one would use: <a class="el" href="iuf3_d_parametric_source_8h.html#a6dbbd55752211aa04583a87b3fc18f74" title="Construct a (number of) source point(s) using a parametric description of their locations. ">iuf3DParametricSourceCreate()</a>. Please note that when one wants to compound individual insonifications from each point on the arc (i.e. fire individual pulses from each point source) then a pattern needs to be created for each of these insonifications and therefore also a source for each of these. In such a case each source then just contains a signle point. A <a class="el" href="iuf_source_private_8h.html#struct_iuf_source">IufSource</a> is referenced by an <a class="el" href="iuf_pattern_8c.html#struct_iuf_pattern">IufPattern</a> using a string as a key in a dictionary. Typicall an empty dictionary is constructed once with <a class="el" href="iuf_source_dict_8h.html#a3b0bbd5ea70649e0b99451b09c2c90bf" title="Create an empty dictionary. ">iufSourceDictCreate()</a> and sources are added to the dictionary with <a class="el" href="iuf_source_dict_8h.html#ab4a264fcbe27148800e069a7a299503b" title="Add a sources to the dictionary. ">iufSourceDictSet()</a></p>
<h2><a class="anchor" id="IufReceiveSettings"></a>
IufReceiveSettings</h2>
<p>The receive settings are a collection of parameters that describe the acquisition settings closely relating to the Analog to Digital Conversion of the data. It consists of:</p><ul>
<li>float <em>sampleFrequency</em>: the data acqisition rate</li>
<li>float <em>startDelay</em>: The time between the 1st sample and the timeStamp of the pattern</li>
<li>int <em>numSamplesPerLine</em>: The number of samples acquired</li>
<li>iutgc_t <em>TGC</em>: the Time Gain Control for these sampels: the tgc contains two arrays: time,gain describing or approximating the ADC amplifier function. An <a class="el" href="iuf_t_g_c_8c.html#struct_iuf_t_g_c">IufTGC</a> is constructed using <a class="el" href="iuf_t_g_c_8h.html#a67675fbbab0d1a249f807bab14c77870" title="Create an empty TGC function of numTGC values. ">iufTGCCreate()</a> and filled by setting the time/gain pairs at each index using <a class="el" href="iuf_t_g_c_8h.html#af4e031a1867aec28419aee1d0f3b66d7" title="Set a [time,gain] pair of the TGC function at index. ">iufTGCSet()</a></li>
</ul>
<p>An <a class="el" href="iuf_pattern_8c.html#struct_iuf_pattern">IufPattern</a> references an <a class="el" href="iuf_receive_settings_8c.html#struct_iuf_receive_settings">IufReceiveSettings</a> with a string in a dictionary. Typically an empty disctionary is constructed once using <a class="el" href="iuf_receive_settings_dict_8h.html#a2c29c4f30d164113bb1a896eb6815469" title="create an empty dictionary ">iufReceiveSettingsDictCreate()</a> and <a class="el" href="iuf_receive_settings_8c.html#struct_iuf_receive_settings">IufReceiveSettings</a> are added to it with <a class="el" href="iuf_receive_settings_dict_8h.html#a241b0110cb27291f3e600f9f000db9a1" title="Get the IufReceiveSettings from the dictionary that has the label key. ">iufReceiveSettingsDictSet()</a>. The receive settings can be created using <a class="el" href="iuf_receive_settings_8h.html#aad7846bfd3b76371567895a41b0e31e5">iufReceiveSettingsCreate()</a>.</p>
<h2><a class="anchor" id="IufReceiveChannelMap"></a>
IufReceiveChannelMap</h2>
<p>THe receiveChannelMap contains a mapping table describing how the transducer elements are fit to the <em>numChannels</em> receiving channels. Typically, not all elements can be captured simultaneously by an ultrasound system so <em>numChannels</em> is typically smaller then <em>numElements</em>. The <a class="el" href="iuf_receive_channel_map_a_d_t_8h.html#struct_iuf_receive_channel_map">IufReceiveChannelMap</a> is <em>numChannels</em> long and contains the indices of the transducer elements. In case there is no channel mapping in place, a channel map needs to be created with a one-to-one mapping, i.e. an identity matrix of size numChannels==numElements. An <a class="el" href="iuf_receive_channel_map_a_d_t_8h.html#struct_iuf_receive_channel_map">IufReceiveChannelMap</a> is constructed with <a class="el" href="iuf_receive_channel_map_8h.html#a9911e01d6309d0c7ad5a248e331e4f8c" title="Create an empty IufReceiveChannelMap with a size of numChannels. ">iufReceiveChannelMapCreate()</a> and set with <a class="el" href="iuf_receive_channel_map_8h.html#ad1e95da7e9493c3f5234786a07163262" title="Sets a transducer index for all channels at once. ">iufReceiveChannelMapSetMap()</a>. To add a <a class="el" href="iuf_receive_channel_map_a_d_t_8h.html#struct_iuf_receive_channel_map">IufReceiveChannelMap</a> to a dictionary use <a class="el" href="iuf_receive_channel_map_dict_8h.html#a3f691a458d9e6e4c4f9a47386104f58c" title="Add a IufReceiveChannelMap with label key to the dictionary. ">iufReceiveChannelMapDictSet()</a> once you have a dictionary created with <a class="el" href="iuf_receive_channel_map_dict_8h.html#af45fb596ded814ebc9473f3b66c108cf" title="Create an empty dictionary. ">iufReceiveChannelMapDictCreate()</a></p>
<h2><a class="anchor" id="IufPulse"></a>
IufPulse</h2>
<p>The shape of the emitted pulse at each source point is described either parametrically or as an array of time-amplitude pairs. In case of an <a class="el" href="iuf_parametric_pulse_8c.html#struct_iuf_parametric_pulse">IufParametricPulse</a> the pulse is considered to consists of a number of sinusoid periods defined by an amplitude, frequency and cycleCount or the pulse is <a class="el" href="iuf_non_parametric_pulse_8c.html#struct_iuf_non_parametric_pulse">IufNonParametricPulse</a> it contains two float arrays of length numPulseValues named: pRawPulseAmplitudes and pRawPulseValues. The pulses are created with resp. <a class="el" href="iuf_parametric_pulse_8h.html#afbf628b23d218b088be005ff4572c5c4">iufParametricPulseCreate()</a> and <a class="el" href="iuf_non_parametric_pulse_8h.html#ade6d5ce3a3acff4153b898529d181b34" title="Create an IufNonParametricPulse for a wave function with numPulseValues {time,voltage} pairs...">iufNonParametricPulseCreate()</a> and both can be added to an <a class="el" href="iuf_pulse_dict_8c.html#struct_iuf_pulse_dict">IufPulseDict</a> using <a class="el" href="iuf_pulse_dict_8h.html#adcd0a681f3e8e4eb7c9c112fa44a3b60" title="Add the IufPulse to the dictionary with label key. ">iufPulseDictSet()</a> once a pulse dictionary is created using <a class="el" href="iuf_pulse_dict_8h.html#addb280bd3c506eb96536c8e24e383ae6" title="Create an empty dictionary of IufPulse objects. ">iufPulseDictCreate()</a>.</p>
<h2><a class="anchor" id="IufTransmitApodization"></a>
IufTransmitApodization</h2>
<p>The transmit Apodization describes the per-element gain of the transducer and is is allowed to change each <a class="el" href="iuf_pattern_8c.html#struct_iuf_pattern">IufPattern</a>. The <a class="el" href="iuf_transmit_apodization_private_8h.html#struct_iuf_transmit_apodization">IufTransmitApodization</a> is an array of floats of length <em>numElements</em>. I.e. there should be a gain for each transducer element. an <a class="el" href="iuf_transmit_apodization_private_8h.html#struct_iuf_transmit_apodization">IufTransmitApodization</a> is created with <a class="el" href="iuf_transmit_apodization_8h.html#ac535780128ecd9407384b5a3c507a8cf" title="Construct an IufTransmitApodization of size numElements. ">iufTransmitApodizationCreate()</a>, set with <a class="el" href="iuf_transmit_apodization_8c.html#a8e07ad330cc7ff674af85892b478e143">iufTransmitApodizationSetApodization()</a> and added to a dictionary with <a class="el" href="iuf_transmit_apodization_dict_8h.html#a1004a01189608c6bce57b28d8f17a7bb" title="Add a IufTransmitApodization with the label key to the dict. ">iufTransmitApodizationDictSet()</a></p>
<h1><a class="anchor" id="iufCWCFile"></a>
iufCWCFile</h1>
<h1><a class="anchor" id="iufBModeFile"></a>
iufBModeFile</h1>
<h1><a class="anchor" id="iufColorDopplerFile"></a>
iufColorDopplerFile</h1>
<p>etc... / </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
